(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-mine-avatar-index"],{"1e29":function(n,r,t){"use strict";t.d(r,"b",(function(){return e})),t.d(r,"c",(function(){return a})),t.d(r,"a",(function(){}));var e=function(){var n=this,r=n.$createElement,t=n._self._c||r;return t("v-uni-view",{staticClass:"container"},[t("v-uni-view",{staticClass:"page-body uni-content-info"},[t("v-uni-view",{staticClass:"cropper-content"},[n.isShowImg?t("v-uni-view",{staticClass:"uni-corpper",style:"width:"+n.cropperInitW+"px;height:"+n.cropperInitH+"px;background:#000"},[t("v-uni-view",{staticClass:"uni-corpper-content",style:"width:"+n.cropperW+"px;height:"+n.cropperH+"px;left:"+n.cropperL+"px;top:"+n.cropperT+"px"},[t("v-uni-image",{style:"width:"+n.cropperW+"px;height:"+n.cropperH+"px",attrs:{src:n.imageSrc}}),t("v-uni-view",{staticClass:"uni-corpper-crop-box",style:"left:"+n.cutL+"px;top:"+n.cutT+"px;right:"+n.cutR+"px;bottom:"+n.cutB+"px",on:{touchstart:function(r){r.stopPropagation(),arguments[0]=r=n.$handleEvent(r),n.contentStartMove.apply(void 0,arguments)},touchmove:function(r){r.stopPropagation(),arguments[0]=r=n.$handleEvent(r),n.contentMoveing.apply(void 0,arguments)},touchend:function(r){r.stopPropagation(),arguments[0]=r=n.$handleEvent(r),n.contentTouchEnd.apply(void 0,arguments)}}},[t("v-uni-view",{staticClass:"uni-cropper-view-box"},[t("v-uni-view",{staticClass:"uni-cropper-dashed-h"}),t("v-uni-view",{staticClass:"uni-cropper-dashed-v"}),t("v-uni-view",{staticClass:"uni-cropper-line-t",attrs:{"data-drag":"top"},on:{touchstart:function(r){r.stopPropagation(),arguments[0]=r=n.$handleEvent(r),n.dragStart.apply(void 0,arguments)},touchmove:function(r){r.stopPropagation(),arguments[0]=r=n.$handleEvent(r),n.dragMove.apply(void 0,arguments)}}}),t("v-uni-view",{staticClass:"uni-cropper-line-r",attrs:{"data-drag":"right"},on:{touchstart:function(r){r.stopPropagation(),arguments[0]=r=n.$handleEvent(r),n.dragStart.apply(void 0,arguments)},touchmove:function(r){r.stopPropagation(),arguments[0]=r=n.$handleEvent(r),n.dragMove.apply(void 0,arguments)}}}),t("v-uni-view",{staticClass:"uni-cropper-line-b",attrs:{"data-drag":"bottom"},on:{touchstart:function(r){r.stopPropagation(),arguments[0]=r=n.$handleEvent(r),n.dragStart.apply(void 0,arguments)},touchmove:function(r){r.stopPropagation(),arguments[0]=r=n.$handleEvent(r),n.dragMove.apply(void 0,arguments)}}}),t("v-uni-view",{staticClass:"uni-cropper-line-l",attrs:{"data-drag":"left"},on:{touchstart:function(r){r.stopPropagation(),arguments[0]=r=n.$handleEvent(r),n.dragStart.apply(void 0,arguments)},touchmove:function(r){r.stopPropagation(),arguments[0]=r=n.$handleEvent(r),n.dragMove.apply(void 0,arguments)}}}),t("v-uni-view",{staticClass:"uni-cropper-point point-t",attrs:{"data-drag":"top"},on:{touchstart:function(r){r.stopPropagation(),arguments[0]=r=n.$handleEvent(r),n.dragStart.apply(void 0,arguments)},touchmove:function(r){r.stopPropagation(),arguments[0]=r=n.$handleEvent(r),n.dragMove.apply(void 0,arguments)}}}),t("v-uni-view",{staticClass:"uni-cropper-point point-tr",attrs:{"data-drag":"topTight"}}),t("v-uni-view",{staticClass:"uni-cropper-point point-r",attrs:{"data-drag":"right"},on:{touchstart:function(r){r.stopPropagation(),arguments[0]=r=n.$handleEvent(r),n.dragStart.apply(void 0,arguments)},touchmove:function(r){r.stopPropagation(),arguments[0]=r=n.$handleEvent(r),n.dragMove.apply(void 0,arguments)}}}),t("v-uni-view",{staticClass:"uni-cropper-point point-rb",attrs:{"data-drag":"rightBottom"},on:{touchstart:function(r){r.stopPropagation(),arguments[0]=r=n.$handleEvent(r),n.dragStart.apply(void 0,arguments)},touchmove:function(r){r.stopPropagation(),arguments[0]=r=n.$handleEvent(r),n.dragMove.apply(void 0,arguments)}}}),t("v-uni-view",{staticClass:"uni-cropper-point point-b",attrs:{"data-drag":"bottom"},on:{touchstart:function(r){r.stopPropagation(),arguments[0]=r=n.$handleEvent(r),n.dragStart.apply(void 0,arguments)},touchmove:function(r){r.stopPropagation(),arguments[0]=r=n.$handleEvent(r),n.dragMove.apply(void 0,arguments)},touchend:function(r){r.stopPropagation(),arguments[0]=r=n.$handleEvent(r),n.dragEnd.apply(void 0,arguments)}}}),t("v-uni-view",{staticClass:"uni-cropper-point point-bl",attrs:{"data-drag":"bottomLeft"}}),t("v-uni-view",{staticClass:"uni-cropper-point point-l",attrs:{"data-drag":"left"},on:{touchstart:function(r){r.stopPropagation(),arguments[0]=r=n.$handleEvent(r),n.dragStart.apply(void 0,arguments)},touchmove:function(r){r.stopPropagation(),arguments[0]=r=n.$handleEvent(r),n.dragMove.apply(void 0,arguments)}}}),t("v-uni-view",{staticClass:"uni-cropper-point point-lt",attrs:{"data-drag":"leftTop"}})],1)],1)],1)],1):n._e()],1),t("v-uni-view",{staticClass:"cropper-config"},[t("v-uni-button",{staticStyle:{"margin-top":"30rpx"},attrs:{type:"primary reverse"},on:{click:function(r){arguments[0]=r=n.$handleEvent(r),n.getImage.apply(void 0,arguments)}}},[n._v("选择头像")]),t("v-uni-button",{staticStyle:{"margin-top":"30rpx"},attrs:{type:"warn"},on:{click:function(r){arguments[0]=r=n.$handleEvent(r),n.getImageInfo.apply(void 0,arguments)}}},[n._v("提交")])],1),t("v-uni-canvas",{style:"position:absolute;border: 1px solid red; width:"+n.imageW+"px;height:"+n.imageH+"px;top:-9999px;left:-9999px;",attrs:{"canvas-id":"myCanvas"}})],1)],1)},a=[]},2456:function(n,r,t){"use strict";t("7a82");var e=t("4ea4").default;Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,t("d3b7"),t("159b"),t("b64b");var a,o,i,p,s,c,d,u,l,h,v=e(t("b6e6")),g=e(t("e7bf")),f=t("2e3e"),b=v.default.baseUrl,m=uni.getSystemInfoSync(),w=m.screenWidth,y=(m.pixelRatio,100),x=m.screenWidth,k={data:function(){return{imageSrc:g.default.getters.avatar,isShowImg:!1,cropperInitW:w,cropperInitH:w,cropperW:w,cropperH:w,cropperL:0,cropperT:0,transL:0,transT:0,scaleP:0,imageW:0,imageH:0,cutL:0,cutT:0,cutB:w,cutR:"100%",qualityWidth:x,innerAspectRadio:1}},onReady:function(){this.loadImage()},methods:{setData:function(n){var r=this;Object.keys(n).forEach((function(t){r.$set(r.$data,t,n[t])}))},getImage:function(){var n=this;uni.chooseImage({success:function(r){n.setData({imageSrc:r.tempFilePaths[0]}),n.loadImage()}})},loadImage:function(){var n=this;uni.getImageInfo({src:n.imageSrc,success:function(r){1,l=w,h=w/1;var t=l>h?l:h;y=t>y?y:t;var e=Math.ceil((w/1-(w/1-y))/2),a=e,o=Math.ceil((w-w+y)/2),i=o;n.setData({cropperW:w,cropperH:w/1,cropperL:Math.ceil((w-w)/2),cropperT:Math.ceil((w-w/1)/2),cutL:o,cutT:e,cutR:i,cutB:a,imageW:l,imageH:h,scaleP:l/w,qualityWidth:x,innerAspectRadio:1}),n.setData({isShowImg:!0}),uni.hideLoading()}})},contentStartMove:function(n){a=n.touches[0].pageX,o=n.touches[0].pageY},contentMoveing:function(n){var r=1*(a-n.touches[0].pageX),t=1*(o-n.touches[0].pageY);r>0?this.cutL-r<0&&(r=this.cutL):this.cutR+r<0&&(r=-this.cutR),t>0?this.cutT-t<0&&(t=this.cutT):this.cutB+t<0&&(t=-this.cutB),this.setData({cutL:this.cutL-r,cutT:this.cutT-t,cutR:this.cutR+r,cutB:this.cutB+t}),a=n.touches[0].pageX,o=n.touches[0].pageY},contentTouchEnd:function(){},getImageInfo:function(){var n=this;uni.showLoading({title:"图片生成中..."});var r=uni.createCanvasContext("myCanvas");r.drawImage(n.imageSrc,0,0,l,h),r.draw(!0,(function(){var r=(n.cropperW-n.cutL-n.cutR)/n.cropperW*l,t=(n.cropperH-n.cutT-n.cutB)/n.cropperH*h,e=n.cutL/n.cropperW*l,a=n.cutT/n.cropperH*h;uni.canvasToTempFilePath({x:e,y:a,width:r,height:t,destWidth:r,destHeight:t,quality:.5,canvasId:"myCanvas",success:function(n){uni.hideLoading();var r={name:"avatarfile",filePath:n.tempFilePath};(0,f.uploadAvatar)(r).then((function(n){g.default.commit("SET_AVATAR",b+n.imgUrl),uni.showToast({title:"修改成功",icon:"success"}),uni.navigateBack()}))}})}))},dragStart:function(n){i=n.touches[0].pageX,p=n.touches[0].pageY,s=this.cutL,d=this.cutR,u=this.cutB,c=this.cutT},dragMove:function(n){var r=n.target.dataset.drag;switch(r){case"right":var t=1*(i-n.touches[0].pageX);d+t<0&&(t=-d),this.setData({cutR:d+t});break;case"left":t=1*(i-n.touches[0].pageX);s-t<0&&(t=s),s-t>this.cropperW-this.cutR&&(t=s-(this.cropperW-this.cutR)),this.setData({cutL:s-t});break;case"top":t=1*(p-n.touches[0].pageY);c-t<0&&(t=c),c-t>this.cropperH-this.cutB&&(t=c-(this.cropperH-this.cutB)),this.setData({cutT:c-t});break;case"bottom":t=1*(p-n.touches[0].pageY);u+t<0&&(t=-u),this.setData({cutB:u+t});break;case"rightBottom":var e=1*(i-n.touches[0].pageX),a=1*(p-n.touches[0].pageY);u+a<0&&(a=-u),d+e<0&&(e=-d);var o=u+a,l=d+e;this.setData({cutB:o,cutR:l});break;default:break}}}};r.default=k},"3b01":function(n,r,t){"use strict";t.r(r);var e=t("1e29"),a=t("f749");for(var o in a)["default"].indexOf(o)<0&&function(n){t.d(r,n,(function(){return a[n]}))}(o);t("ea45");var i=t("f0c5"),p=Object(i["a"])(a["default"],e["b"],e["c"],!1,null,"620fed95",null,!1,e["a"],void 0);r["default"]=p.exports},"4be7":function(n,r,t){var e=t("ab81");e.__esModule&&(e=e.default),"string"===typeof e&&(e=[[n.i,e,""]]),e.locals&&(n.exports=e.locals);var a=t("4f06").default;a("12d8ccbe",e,!0,{sourceMap:!1,shadowMode:!1})},ab81:function(n,r,t){var e=t("24fb");r=e(!1),r.push([n.i,'\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/* pages/uni-cropper/index.wxss */.uni-content-info[data-v-620fed95]{position:fixed;top:0;left:0;right:0;bottom:0;display:block;align-items:center;flex-direction:column}.cropper-config[data-v-620fed95]{padding:%?20?% %?40?%}.cropper-content[data-v-620fed95]{min-height:%?750?%;width:100%}.uni-corpper[data-v-620fed95]{position:relative;overflow:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none;box-sizing:border-box}.uni-corpper-content[data-v-620fed95]{position:relative}.uni-corpper-content uni-image[data-v-620fed95]{display:block;width:100%;min-width:0!important;max-width:none!important;height:100%;min-height:0!important;max-height:none!important;image-orientation:0deg!important;margin:0 auto}\r\n\r\n/* 移动图片效果 */.uni-cropper-drag-box[data-v-620fed95]{position:absolute;top:0;right:0;bottom:0;left:0;cursor:move;background:rgba(0,0,0,.6);z-index:1}\r\n\r\n/* 内部的信息 */.uni-corpper-crop-box[data-v-620fed95]{position:absolute;background:hsla(0,0%,100%,.3);z-index:2}.uni-corpper-crop-box .uni-cropper-view-box[data-v-620fed95]{position:relative;display:block;width:100%;height:100%;overflow:visible;outline:%?1?% solid #69f;outline-color:rgba(102,153,255,.75)}\r\n\r\n/* 横向虚线 */.uni-cropper-dashed-h[data-v-620fed95]{position:absolute;top:33.33333333%;left:0;width:100%;height:33.33333333%;border-top:%?1?% dashed hsla(0,0%,100%,.5);border-bottom:%?1?% dashed hsla(0,0%,100%,.5)}\r\n\r\n/* 纵向虚线 */.uni-cropper-dashed-v[data-v-620fed95]{position:absolute;left:33.33333333%;top:0;width:33.33333333%;height:100%;border-left:%?1?% dashed hsla(0,0%,100%,.5);border-right:%?1?% dashed hsla(0,0%,100%,.5)}\r\n\r\n/* 四个方向的线  为了之后的拖动事件*/.uni-cropper-line-t[data-v-620fed95]{position:absolute;display:block;width:100%;background-color:#69f;top:0;left:0;height:%?1?%;opacity:.1;cursor:n-resize}.uni-cropper-line-t[data-v-620fed95]::before{content:"";position:absolute;top:50%;right:%?0?%;width:100%;-webkit-transform:translate3d(0,-50%,0);transform:translate3d(0,-50%,0);bottom:0;height:%?41?%;background:transparent;z-index:11}.uni-cropper-line-r[data-v-620fed95]{position:absolute;display:block;background-color:#69f;top:0;right:%?0?%;width:%?1?%;opacity:.1;height:100%;cursor:e-resize}.uni-cropper-line-r[data-v-620fed95]::before{content:"";position:absolute;top:0;left:50%;width:%?41?%;-webkit-transform:translate3d(-50%,0,0);transform:translate3d(-50%,0,0);bottom:0;height:100%;background:transparent;z-index:11}.uni-cropper-line-b[data-v-620fed95]{position:absolute;display:block;width:100%;background-color:#69f;bottom:0;left:0;height:%?1?%;opacity:.1;cursor:s-resize}.uni-cropper-line-b[data-v-620fed95]::before{content:"";position:absolute;top:50%;right:%?0?%;width:100%;-webkit-transform:translate3d(0,-50%,0);transform:translate3d(0,-50%,0);bottom:0;height:%?41?%;background:transparent;z-index:11}.uni-cropper-line-l[data-v-620fed95]{position:absolute;display:block;background-color:#69f;top:0;left:0;width:%?1?%;opacity:.1;height:100%;cursor:w-resize}.uni-cropper-line-l[data-v-620fed95]::before{content:"";position:absolute;top:0;left:50%;width:%?41?%;-webkit-transform:translate3d(-50%,0,0);transform:translate3d(-50%,0,0);bottom:0;height:100%;background:transparent;z-index:11}.uni-cropper-point[data-v-620fed95]{width:%?5?%;height:%?5?%;background-color:#69f;opacity:.75;position:absolute;z-index:3}.point-t[data-v-620fed95]{top:%?-3?%;left:50%;margin-left:%?-3?%;cursor:n-resize}.point-tr[data-v-620fed95]{top:%?-3?%;left:100%;margin-left:%?-3?%;cursor:n-resize}.point-r[data-v-620fed95]{top:50%;left:100%;margin-left:%?-3?%;margin-top:%?-3?%;cursor:n-resize}.point-rb[data-v-620fed95]{left:100%;top:100%;-webkit-transform:translate3d(-50%,-50%,0);transform:translate3d(-50%,-50%,0);cursor:n-resize;width:%?36?%;height:%?36?%;background-color:#69f;position:absolute;z-index:1112;opacity:1}.point-b[data-v-620fed95]{left:50%;top:100%;margin-left:%?-3?%;margin-top:%?-3?%;cursor:n-resize}.point-bl[data-v-620fed95]{left:0;top:100%;margin-left:%?-3?%;margin-top:%?-3?%;cursor:n-resize}.point-l[data-v-620fed95]{left:0;top:50%;margin-left:%?-3?%;margin-top:%?-3?%;cursor:n-resize}.point-lt[data-v-620fed95]{left:0;top:0;margin-left:%?-3?%;margin-top:%?-3?%;cursor:n-resize}\r\n\r\n/* 裁剪框预览内容 */.uni-cropper-viewer[data-v-620fed95]{position:relative;width:100%;height:100%;overflow:hidden}.uni-cropper-viewer uni-image[data-v-620fed95]{position:absolute;z-index:2}',""]),n.exports=r},ea45:function(n,r,t){"use strict";var e=t("4be7"),a=t.n(e);a.a},f749:function(n,r,t){"use strict";t.r(r);var e=t("2456"),a=t.n(e);for(var o in e)["default"].indexOf(o)<0&&function(n){t.d(r,n,(function(){return e[n]}))}(o);r["default"]=a.a}}]);